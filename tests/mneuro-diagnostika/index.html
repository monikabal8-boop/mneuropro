<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mneuro‚Ñ¢ –¢–µ—Å—Ç</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .container {
            text-align: center;
            max-width: 900px;
            padding: 20px;
            width: 100%;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 300;
            letter-spacing: 3px;
            margin-bottom: 30px;
            color: #a8d5e5;
        }
        
        .logo span {
            font-weight: 600;
        }
        
        .screen {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(10px);
            display: none;
        }
        
        .screen.active {
            display: block;
        }
        
        h1 {
            font-size: 24px;
            font-weight: 400;
            margin-bottom: 20px;
        }
        
        p {
            font-size: 16px;
            line-height: 1.7;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 30px;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
            -webkit-tap-highlight-color: transparent;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .categories {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            gap: 20px;
        }
        
        .category {
            padding: 25px 20px;
            border-radius: 15px;
            font-size: 20px;
            font-weight: 600;
            flex: 1;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
            -webkit-tap-highlight-color: transparent;
            border: none;
        }
        
        .category:active {
            transform: scale(0.95);
        }
        
        .category-left {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
        
        .category-right {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
        }
        
        .key-hint {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 8px;
        }
        
        .stimulus-area {
            height: 250px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }
        
        .stimulus {
            font-size: 120px;
        }
        
        .feedback {
            height: 50px;
            font-size: 32px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .feedback.correct {
            color: #38ef7d;
        }
        
        .feedback.incorrect {
            color: #f45c43;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s;
            width: 0%;
        }
        
        .result-score {
            font-size: 72px;
            font-weight: 700;
            margin: 30px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .result-interpretation {
            font-size: 18px;
            margin: 20px 0;
            padding: 20px;
            border-radius: 15px;
            background: rgba(255,255,255,0.1);
            line-height: 1.6;
        }
        
        .result-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 30px;
        }
        
        .detail-box {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 15px;
        }
        
        .detail-label {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }
        
        .detail-value {
            font-size: 24px;
            font-weight: 600;
        }
        
        .instructions {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .instructions li {
            margin: 10px 0;
            padding-left: 10px;
        }
        
        .examples {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .example-group {
            text-align: center;
        }
        
        .example-icons {
            font-size: 50px;
            margin-bottom: 10px;
        }
        
        .example-label-green {
            color: #38ef7d;
        }
        
        .example-label-red {
            color: #f45c43;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .screen {
                padding: 20px;
            }
            
            .category {
                padding: 20px 10px;
                font-size: 16px;
            }
            
            .stimulus {
                font-size: 80px;
            }
            
            .result-details {
                grid-template-columns: 1fr;
            }
            
            .key-hint {
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <a href="/tests/" style="position:fixed;top:20px;left:20px;color:rgba(0,150,255,0.7);text-decoration:none;font-size:0.9rem;z-index:100;">‚Üê –ù–∞–∑–∞–¥</a>
    <div class="container">
        <div class="logo"><span>Mneuro</span>‚Ñ¢</div>
        
        <!-- Screen 1: Intro -->
        <div id="intro" class="screen active">
            <h1>–ò–º–ø–ª–∏—Ü–∏—Ç–µ–Ω —Ç–µ—Å—Ç</h1>
            <p>–¢–æ–∑–∏ —Ç–µ—Å—Ç –∏–∑–º–µ—Ä–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ç–µ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –≤–∞—à–µ—Ç–æ –ø–æ–¥—Å—ä–∑–Ω–∞–Ω–∏–µ.</p>
            <p>–©–µ –≤–∏–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª–∏. –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–∞–π—Ç–µ –≥–∏ –≤—ä–∑–º–æ–∂–Ω–æ –Ω–∞–π-–±—ä—Ä–∑–æ.</p>
            <p style="font-size: 13px; opacity: 0.6; margin-top: 20px;">–°—ä–∑–¥–∞–¥–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –Ω–∞ IAT (Implicit Association Test) ‚Äî –Ω–∞—É—á–µ–Ω –º–µ—Ç–æ–¥ –æ—Ç 1998 –≥., Harvard University.</p>
            <div class="instructions">
                <p><strong>–ö–∞–∫ —Å–µ –∏–≥—Ä–∞–µ:</strong></p>
                <ul>
                    <li>–ù–∞—Ç–∏—Å–Ω–µ—Ç–µ <strong>–∑–µ–ª–µ–Ω–∏—è –±—É—Ç–æ–Ω</strong> –∑–∞ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢</li>
                    <li>–ù–∞—Ç–∏—Å–Ω–µ—Ç–µ <strong>—á–µ—Ä–≤–µ–Ω–∏—è –±—É—Ç–æ–Ω</strong> –∑–∞ –ó–ê–ü–õ–ê–•–ê</li>
                    <li>–†–µ–∞–≥–∏—Ä–∞–π—Ç–µ –≤—ä–∑–º–æ–∂–Ω–æ –Ω–∞–π-–±—ä—Ä–∑–æ!</li>
                </ul>
            </div>
            <button class="btn" id="start-btn">–ó–ê–ü–û–ß–ù–ò</button>
        </div>
        
        <!-- Screen 2: Practice Intro -->
        <div id="practice-intro" class="screen">
            <h1>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</h1>
            <p>–ü—ä—Ä–≤–æ —â–µ —Å–µ —É–ø—Ä–∞–∂–Ω–∏—Ç–µ.</p>
            <div class="examples">
                <div class="example-group">
                    <div class="example-icons">üè† üåÖ ü§ù</div>
                    <div class="example-label-green">= –ë–ï–ó–û–ü–ê–°–ù–û–°–¢</div>
                </div>
                <div class="example-group">
                    <div class="example-icons">‚ö° üî• üëÅÔ∏è</div>
                    <div class="example-label-red">= –ó–ê–ü–õ–ê–•–ê</div>
                </div>
            </div>
            <button class="btn" id="practice-btn">–¢–†–ï–ù–ò–†–û–í–ö–ê</button>
        </div>
        
        <!-- Screen 3: Game Area -->
        <div id="game-area" class="screen">
            <div class="categories">
                <button class="category category-left" id="btn-safety">
                    –ë–ï–ó–û–ü–ê–°–ù–û–°–¢
                    <div class="key-hint">–∏–ª–∏ –∫–ª–∞–≤–∏—à E</div>
                </button>
                <button class="category category-right" id="btn-threat">
                    –ó–ê–ü–õ–ê–•–ê
                    <div class="key-hint">–∏–ª–∏ –∫–ª–∞–≤–∏—à I</div>
                </button>
            </div>
            
            <div class="stimulus-area">
                <div class="stimulus" id="stimulus">üè†</div>
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
        </div>
        
        <!-- Screen 4: Test Intro -->
        <div id="test-intro" class="screen">
            <h1>–ì–æ—Ç–æ–≤–∏ –∑–∞ —Ç–µ—Å—Ç–∞!</h1>
            <p>–û—Ç–ª–∏—á–Ω–æ! –°–µ–≥–∞ –∑–∞–ø–æ—á–≤–∞ –∏—Å—Ç–∏–Ω—Å–∫–∏—è—Ç —Ç–µ—Å—Ç.</p>
            <p>–†–µ–∞–≥–∏—Ä–∞–π—Ç–µ –≤—ä–∑–º–æ–∂–Ω–æ –Ω–∞–π-–±—ä—Ä–∑–æ!</p>
            <button class="btn" id="test-btn">–°–¢–ê–†–¢</button>
        </div>
        
        <!-- Screen 5: Results -->
        <div id="results" class="screen">
            <h1>–†–µ–∑—É–ª—Ç–∞—Ç–∏</h1>
            <div class="result-score" id="score">75</div>
            <div class="result-interpretation" id="interpretation"></div>
            <div class="result-details">
                <div class="detail-box">
                    <div class="detail-label">–í—Ä–µ–º–µ –∑–∞ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢</div>
                    <div class="detail-value" id="safety-time">0 ms</div>
                </div>
                <div class="detail-box">
                    <div class="detail-label">–í—Ä–µ–º–µ –∑–∞ –ó–ê–ü–õ–ê–•–ê</div>
                    <div class="detail-value" id="threat-time">0 ms</div>
                </div>
                <div class="detail-box">
                    <div class="detail-label">–¢–æ—á–Ω–æ—Å—Ç</div>
                    <div class="detail-value" id="accuracy">0%</div>
                </div>
                <div class="detail-box">
                    <div class="detail-label">D-Score</div>
                    <div class="detail-value" id="d-score">0</div>
                </div>
            </div>
            <div style="margin-top: 25px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 15px; text-align: left; font-size: 14px; line-height: 1.7; opacity: 0.85;">
                <p style="margin-bottom: 0;"><strong>–ó–∞—â–æ —Ç–æ–≤–∞ —Ä–∞–±–æ—Ç–∏?</strong> –ü–æ–¥—Å—ä–∑–Ω–∞–Ω–∏–µ—Ç–æ —Ä–µ–∞–≥–∏—Ä–∞ –∑–∞ —á–∞—Å—Ç–∏ –æ—Ç —Å–µ–∫—É–Ω–¥–∞—Ç–∞ ‚Äî —Ç–≤—ä—Ä–¥–µ –±—ä—Ä–∑–æ, –∑–∞ –¥–∞ —Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞. –†–∞–∑–ª–∏–∫–∞—Ç–∞ –æ—Ç 50-200 ms –ø–æ–∫–∞–∑–≤–∞ –∫—ä–º –∫–∞–∫–≤–æ –Ω–µ—Ä–≤–Ω–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ –º–æ–º–µ–Ω—Ç–∞.</p>
            </div>
            <button class="btn" id="restart-btn">–ü–û–í–¢–û–†–ò</button>
        </div>
    </div>

    <script>
        // Stimuli - large pools for randomization
        var safetyStimuli = ['üè†', 'üåÖ', 'ü§ù', 'üíö', 'üå≥', '‚òÄÔ∏è', 'üõ°Ô∏è', 'ü§ó', 'üå∏', 'üïäÔ∏è', 'üåà', 'üçÄ', 'üíô', 'üåª', 'üß∏', 'üéÅ', 'üè°', 'üë®‚Äçüë©‚Äçüëß', 'ü§±', 'üíï', 'üå∑', 'ü¶ã', 'üê£', 'üçÉ', 'üå∫', 'üíù', 'üéÄ', 'üèñÔ∏è', '‚õµ', 'üå¥', 'üé†', 'üßÅ', 'üç∞', '‚òï', 'üìö', 'üé®', 'üéµ', 'üåô', '‚≠ê', 'üåü'];
        var threatStimuli = ['‚ö°', 'üî•', 'üëÅÔ∏è', 'üó°Ô∏è', 'üíÄ', 'üå©Ô∏è', 'üò†', 'üêç', '‚ö†Ô∏è', 'üï≥Ô∏è', 'ü¶Ç', 'üï∑Ô∏è', 'üí£', 'üî™', 'üëø', 'üò°', 'üå™Ô∏è', 'ü¶à', 'üê∫', 'üí¢', 'ü©∏', '‚ò†Ô∏è', 'üßü', 'üëπ', 'üò±', 'üÜò', 'üö®', '‚õî', '‚ùå', 'üíî', 'üò∞', 'üò®', 'ü§¨', 'üëä', 'üêä', 'ü¶á', 'üåë', '‚ö∞Ô∏è', 'üñ§', 'üÉè'];
        
        var trials = [];
        var currentTrial = 0;
        var trialStartTime = 0;
        var results = [];
        var isPractice = false;
        var canRespond = false;
        
        function showScreen(id) {
            var screens = document.querySelectorAll('.screen');
            for (var i = 0; i < screens.length; i++) {
                screens[i].classList.remove('active');
            }
            document.getElementById(id).classList.add('active');
        }
        
        function generateTrials(practice) {
            trials = [];
            if (practice) {
                trials = [
                    { stimulus: 'üè†', category: 'safety', correctKey: 'e' },
                    { stimulus: '‚ö°', category: 'threat', correctKey: 'i' },
                    { stimulus: 'üåÖ', category: 'safety', correctKey: 'e' },
                    { stimulus: 'üî•', category: 'threat', correctKey: 'i' },
                    { stimulus: 'ü§ù', category: 'safety', correctKey: 'e' },
                    { stimulus: 'üëÅÔ∏è', category: 'threat', correctKey: 'i' }
                ];
            } else {
                // Shuffle and pick random 10 from each pool
                var shuffledSafety = safetyStimuli.slice().sort(function() { return Math.random() - 0.5; });
                var shuffledThreat = threatStimuli.slice().sort(function() { return Math.random() - 0.5; });
                
                for (var i = 0; i < 10; i++) {
                    trials.push({ stimulus: shuffledSafety[i], category: 'safety', correctKey: 'e' });
                    trials.push({ stimulus: shuffledThreat[i], category: 'threat', correctKey: 'i' });
                }
                // Shuffle trials order
                for (var i = trials.length - 1; i > 0; i--) {
                    var j = Math.floor(Math.random() * (i + 1));
                    var temp = trials[i];
                    trials[i] = trials[j];
                    trials[j] = temp;
                }
            }
        }
        
        function startPractice() {
            isPractice = true;
            generateTrials(true);
            currentTrial = 0;
            results = [];
            showScreen('game-area');
            document.getElementById('progress').style.width = '0%';
            setTimeout(showNextStimulus, 800);
        }
        
        function startTest() {
            isPractice = false;
            generateTrials(false);
            currentTrial = 0;
            results = [];
            showScreen('game-area');
            document.getElementById('progress').style.width = '0%';
            setTimeout(showNextStimulus, 800);
        }
        
        function showNextStimulus() {
            if (currentTrial >= trials.length) {
                canRespond = false;
                if (isPractice) {
                    showScreen('test-intro');
                } else {
                    showResults();
                }
                return;
            }
            
            var trial = trials[currentTrial];
            document.getElementById('stimulus').textContent = trial.stimulus;
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('progress').style.width = (currentTrial / trials.length * 100) + '%';
            
            canRespond = true;
            trialStartTime = performance.now();
        }
        
        function respond(key) {
            if (!canRespond || currentTrial >= trials.length) return;
            canRespond = false;
            
            var trial = trials[currentTrial];
            var reactionTime = performance.now() - trialStartTime;
            var isCorrect = key === trial.correctKey;
            
            // Feedback
            var feedback = document.getElementById('feedback');
            feedback.textContent = isCorrect ? '‚úì' : '‚úó';
            feedback.className = 'feedback ' + (isCorrect ? 'correct' : 'incorrect');
            
            // Store
            if (!isPractice) {
                results.push({
                    category: trial.category,
                    reactionTime: reactionTime,
                    isCorrect: isCorrect
                });
            }
            
            currentTrial++;
            setTimeout(showNextStimulus, 500);
        }
        
        function showResults() {
            var safetyTrials = [];
            var threatTrials = [];
            for (var i = 0; i < results.length; i++) {
                if (results[i].category === 'safety' && results[i].isCorrect) {
                    safetyTrials.push(results[i]);
                }
                if (results[i].category === 'threat' && results[i].isCorrect) {
                    threatTrials.push(results[i]);
                }
            }
            
            var sumSafety = 0;
            for (var i = 0; i < safetyTrials.length; i++) {
                sumSafety += safetyTrials[i].reactionTime;
            }
            var avgSafetyTime = safetyTrials.length > 0 ? sumSafety / safetyTrials.length : 999;
            
            var sumThreat = 0;
            for (var i = 0; i < threatTrials.length; i++) {
                sumThreat += threatTrials[i].reactionTime;
            }
            var avgThreatTime = threatTrials.length > 0 ? sumThreat / threatTrials.length : 999;
            
            var correctCount = 0;
            for (var i = 0; i < results.length; i++) {
                if (results[i].isCorrect) correctCount++;
            }
            var accuracy = Math.round(correctCount / results.length * 100);
            
            // D-Score
            var allCorrect = [];
            for (var i = 0; i < results.length; i++) {
                if (results[i].isCorrect) allCorrect.push(results[i]);
            }
            
            var sumAll = 0;
            for (var i = 0; i < allCorrect.length; i++) {
                sumAll += allCorrect[i].reactionTime;
            }
            var mean = sumAll / allCorrect.length;
            
            var sumVariance = 0;
            for (var i = 0; i < allCorrect.length; i++) {
                sumVariance += Math.pow(allCorrect[i].reactionTime - mean, 2);
            }
            var variance = sumVariance / allCorrect.length;
            var sd = Math.sqrt(variance);
            var dScore = sd > 0 ? ((avgThreatTime - avgSafetyTime) / sd).toFixed(2) : 0;
            
            // Safety score based on D-Score
            // D-Score range is typically -2 to +2, we map to 0-100
            var dScoreNum = parseFloat(dScore);
            var safetyScore = Math.round(50 + (dScoreNum * 25));
            safetyScore = Math.max(0, Math.min(100, safetyScore));
            
            // Interpretation
            var interpretation;
            var details;
            if (parseFloat(dScore) > 0.2) {
                interpretation = "–í–∏–µ —Ä–∞–∑–ø–æ–∑–Ω–∞–≤–∞—Ç–µ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢ –ø–æ-–±—ä—Ä–∑–æ";
                details = "–í–∞—à–∞—Ç–∞ –Ω–µ—Ä–≤–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫—ä–º —Å–∏–≥—É—Ä–Ω–æ—Å—Ç –∏ –ø–æ–∫–æ–π. –ü–æ–¥—Å—ä–∑–Ω–∞–Ω–∏–µ—Ç–æ –≤–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–±–µ–ª—è–∑–≤–∞ –ø—ä—Ä–≤–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ç–µ —Å–∏–≥–Ω–∞–ª–∏ –æ—Ç —Å—Ä–µ–¥–∞—Ç–∞. –¢–æ–≤–∞ –ø–æ–∫–∞–∑–≤–∞, —á–µ —Å—Ç–µ –≤ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –≤—ä—Ç—Ä–µ—à–Ω–∞ —Å—Ç–∞–±–∏–ª–Ω–æ—Å—Ç.";
            } else if (parseFloat(dScore) < -0.2) {
                interpretation = "–í–∏–µ —Ä–∞–∑–ø–æ–∑–Ω–∞–≤–∞—Ç–µ –ó–ê–ü–õ–ê–•–ê –ø–æ-–±—ä—Ä–∑–æ";
                details = "–í–∞—à–∞—Ç–∞ –Ω–µ—Ä–≤–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –µ –≤ –∑–∞—â–∏—Ç–µ–Ω —Ä–µ–∂–∏–º. –ü–æ–¥—Å—ä–∑–Ω–∞–Ω–∏–µ—Ç–æ –≤–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∫–∞–Ω–∏—Ä–∞ —Å—Ä–µ–¥–∞—Ç–∞ –∑–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –¢–æ–≤–∞ –µ –Ω–æ—Ä–º–∞–ª–Ω–∞ —Ä–µ–∞–∫—Ü–∏—è –ø—Ä–∏ —Å—Ç—Ä–µ—Å –∏–ª–∏ –Ω–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç ‚Äî –º–æ–∑—ä–∫—ä—Ç –≤–∏ –ø–∞–∑–∏, –Ω–æ –∏–∑—Ä–∞–∑—Ö–æ–¥–≤–∞ –ø–æ–≤–µ—á–µ –µ–Ω–µ—Ä–≥–∏—è.";
            } else {
                interpretation = "–ë–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–∞ —Ä–µ–∞–∫—Ü–∏—è";
                details = "–í–∞—à–∞—Ç–∞ –Ω–µ—Ä–≤–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑–≤–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–Ω–æ—Å—Ç –∫—ä–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç –∏ –∑–∞–ø–ª–∞—Ö–∞. –¢–æ–≤–∞ –º–æ–∂–µ –¥–∞ –æ–∑–Ω–∞—á–∞–≤–∞ –ø—Ä–µ—Ö–æ–¥–Ω–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –∏–ª–∏ –¥–æ–±—Ä–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç –∫—ä–º —Å—Ä–µ–¥–∞—Ç–∞.";
            }
            
            document.getElementById('score').textContent = safetyScore;
            document.getElementById('interpretation').innerHTML = '<strong style="font-size: 22px;">' + interpretation + '</strong><br><br>' + details;
            document.getElementById('safety-time').textContent = Math.round(avgSafetyTime) + ' ms';
            document.getElementById('threat-time').textContent = Math.round(avgThreatTime) + ' ms';
            document.getElementById('accuracy').textContent = accuracy + '%';
            document.getElementById('d-score').textContent = dScore;
            
            showScreen('results');
        }
        
        function restart() {
            showScreen('intro');
        }
        
        // Event listeners
        document.getElementById('start-btn').addEventListener('click', function() {
            showScreen('practice-intro');
        });
        
        document.getElementById('practice-btn').addEventListener('click', function() {
            startPractice();
        });
        
        document.getElementById('test-btn').addEventListener('click', function() {
            startTest();
        });
        
        document.getElementById('restart-btn').addEventListener('click', function() {
            restart();
        });
        
        document.getElementById('btn-safety').addEventListener('click', function() {
            respond('e');
        });
        
        document.getElementById('btn-threat').addEventListener('click', function() {
            respond('i');
        });
        
        // Keyboard
        document.addEventListener('keydown', function(e) {
            var key = e.key.toLowerCase();
            if (key === 'e') respond('e');
            if (key === 'i') respond('i');
        });
    </script>
</body>
</html>
